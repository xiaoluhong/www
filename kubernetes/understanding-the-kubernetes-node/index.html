<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Understanding the Kubernetes Node | IT老男孩</title><meta name="keywords" content="IT老男孩,rancher,github rancher,rke,rke2,k3s,docker,kubernetes,devops,多集群管理,容器,Linux运维,网络运维,最佳实践"><meta name="author" content="IT老男孩"><meta name="copyright" content="IT老男孩"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文永久链接: https:&#x2F;&#x2F;www.xtplayer.cn&#x2F;kubernetes&#x2F;understanding-the-kubernetes-node&#x2F;  IntroductionWith over 48,000 stars on GitHub, more than 75,000 commits, and with major contributors like Google and Red H"><meta property="og:type" content="article"><meta property="og:title" content="Understanding the Kubernetes Node"><meta property="og:url" content="https://www.xtplayer.cn/kubernetes/understanding-the-kubernetes-node/index.html"><meta property="og:site_name" content="IT老男孩"><meta property="og:description" content="本文永久链接: https:&#x2F;&#x2F;www.xtplayer.cn&#x2F;kubernetes&#x2F;understanding-the-kubernetes-node&#x2F;  IntroductionWith over 48,000 stars on GitHub, more than 75,000 commits, and with major contributors like Google and Red H"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.xtplayer.cn/img/gkihqEjXxJ5UZ1C.jpg"><meta property="article:published_time" content="2021-03-01T14:21:14.000Z"><meta property="article:modified_time" content="2021-03-23T14:58:20.000Z"><meta property="article:author" content="IT老男孩"><meta property="article:tag" content="IT老男孩,rancher,github rancher,rke,rke2,k3s,docker,kubernetes,devops,多集群管理,容器,Linux运维,网络运维,最佳实践"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.xtplayer.cn/img/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" type="image/png" href="/img/favicon.png"><link rel="canonical" href="https://www.xtplayer.cn/kubernetes/understanding-the-kubernetes-node/"><link rel="preconnect" href="https//cdn.jsdelivr.net"><link rel="preconnect" href="https//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="https//hm.baidu.com"><link rel="preconnect" href="https//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet preload" as="font" href="/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="/css/snackbar.min.css" media="print" onload='this.media="all"'><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-4244806813321801",enable_page_level_ads:"true"})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?08d495d3996be233cf4355e47874fd02";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-WDVQSZ43MX"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-WDVQSZ43MX")</script><script>!function(){var c=document.createElement("script");c.src="https://sf1-scmcdn-tos.pstatp.com/goofy/ttzz/push.js?abca38a75f1ee646121b4cdefd4e13ce89e669412cb977bb98b66029e7fc3cfc8d38a1f1352cfca035e8cdfca27dc395b6c71280cecfa54b697791769b400b8d",c.id="ttzz";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(c,e)}(window)</script><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!1,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#121212",position:"bottom-center"},source:{jQuery:"/js/jquery.min.js",justifiedGallery:{js:"/js/jquery.justifiedGallery.min.js",css:"/css/justifiedGallery.min.css"},fancybox:{js:"/js/jquery.fancybox.min.js",css:"/css/jquery.fancybox.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isanchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-03-23 22:58:20"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)});const t=saveToLocal.get("aside-status");void 0!==t&&("hide"===t?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"))})(window)</script><style>#toggle-sidebar{left:100px}</style><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="IT老男孩" type="application/atom+xml"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpeg" onerror='onerror=null,src="/img/friend_404.gif"' width="110px" height="110px" alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">132</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">96</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page" href="/ad/"><i class="fa-fw fas fa-heart"></i> <span>广告</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">IT老男孩</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>关于</span></a></div><div class="menus_item"><a class="site-page" href="/ad/"><i class="fa-fw fas fa-heart"></i> <span>广告</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4244806813321801" data-ad-slot="4594418186" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div id="post-info"><h1 class="post-title">Understanding the Kubernetes Node</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表:</span> <time class="post-meta-date-created" datetime="2021-03-01T14:21:14.000Z" title="发表 2021-03-01 22:21:14">2021-03-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新:</span> <time class="post-meta-date-updated" datetime="2021-03-23T14:58:20.000Z" title="更新 2021-03-23 22:58:20">2021-03-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><span class="post-meta-label">分类:</span> <a class="post-meta-categories" href="/categories/kubernetes/">kubernetes</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span> <span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span> <span>11分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Understanding the Kubernetes Node"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><p><span>本文永久链接:</span><i class="fa fa-creative-commons"></i> <a rel="noopener external nofollow noreferrer" href="https://www.xtplayer.cn/kubernetes/understanding-the-kubernetes-node/" target="_blank" title="https://www.xtplayer.cn/kubernetes/understanding-the-kubernetes-node/">https://www.xtplayer.cn/kubernetes/understanding-the-kubernetes-node/</a></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>With over 48,000 stars on GitHub, more than 75,000 commits, and with major contributors like Google and Red Hat, Kubernetes has rapidly taken over the container ecosystem to become the true leader of container orchestration platforms. Kubernetes offers great features like rolling and rollback of deployments, container health checks, automatic container recovery, container auto-scaling based on metrics, service load balancing, service discovery (great for microservice architectures), and more. In this article, we will speak about some basic Kubernetes concepts and its master node architecture, concentrating on the node components.</p><h2 id="Understanding-Kubernetes-and-Its-Abstractions"><a href="#Understanding-Kubernetes-and-Its-Abstractions" class="headerlink" title="Understanding Kubernetes and Its Abstractions"></a>Understanding Kubernetes and Its Abstractions</h2><p>Kubernetes is an open-source orchestration engine for automating deployments, scaling, managing, and providing the infrastructure to host containerized applications. At the infrastructure level, a Kubernetes cluster is comprised of a set of physical or virtual machines, each acting in a specific role.</p><p>The <strong>master</strong> machines act as the brain of all operations and are charged with orchestrating containers that run on all of the <strong>node</strong> machines. Each node is equipped with a container runtime. The node receives instruction from the master and then takes actions to either create pods, delete them, or adjust networking rules.</p><img src="/kubernetes/understanding-the-kubernetes-node/01-rancher-k8s-node-components-architecture.png" title="Fig. 1: Kubernetes node components architecture">Fig. 1: Kubernetes node components architecture<ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/concepts/overview/components/#master-components">Master components</a> are responsible for managing the Kubernetes cluster. They manage the life cycle of pods, the base unit of a deployment within a Kubernetes cluster. Master servers run the following components:<ul><li><code>kube-apiserver</code> - the main component, exposing APIs for the other master components.</li><li><code>etcd</code> - distributed key&#x2F;value store which Kubernetes uses for persistent storage of all cluster information.</li><li><code>kube-scheduler</code> - uses information in the pod spec to decide on which node to run a pod.</li><li><code>kube-controller-manager</code> - responsible for node management (detecting if a node fails), pod replication, and endpoint creation.</li><li><code>cloud-controller-manager</code> - daemon acting like an abstraction layer between the APIs and the different cloud providers’ tools (storage volumes, load balancers etc.)</li></ul></li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/concepts/architecture/nodes/#what-is-a-node">Node components</a> are worker machines in Kubernetes and are managed by the Master. A node may be a virtual machine (VM) or physical machine, and Kubernetes runs equally well on both types of systems. Each node contains the necessary components to run pods:<ul><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/"><code>kubelet</code></a> - watches the API server for pods on that node and makes sure they are running</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/google/cadvisor"><code>cAdvisor</code></a> - collects metrics about pods running on that particular node</li><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/"><code>kube-proxy</code></a> - watches the API server for pods&#x2F;services changes in order to maintain the network up to date</li><li>container runtime - responsible for managing container images and running containers on that node</li></ul></li></ul><h2 id="Kubernetes-Node-Components-in-Detail"><a href="#Kubernetes-Node-Components-in-Detail" class="headerlink" title="Kubernetes Node Components in Detail"></a>Kubernetes Node Components in Detail</h2><p>To summarize, the node runs the two most important components, the <code>kubelet</code> and the <code>kube-proxy</code>, as well as a container engine in charge of running the containerized applications.</p><h3 id="kubelet"><a href="#kubelet" class="headerlink" title="kubelet"></a>kubelet</h3><p>The <code>kubelet</code> agent handles all communication between the master and the node on which it is running. It receives commands from the master in the form of a <strong>manifest</strong> which defines the workload and the operating parameters. It interfaces with the container runtime that is responsible for creating, starting, and monitoring pods.</p><p>The <code>kubelet</code> also periodically executes any configured liveness probes and readiness checks. It constantly monitors the state of the pods and, in the event of a problem, launches a new instance instead. The <code>kubelet</code> also has an internal HTTP server exposing a read-only view at port 10255. There’s a health check endpoint at <code>/healthz</code> and also a few additional status endpoints. For example, we can get a list of running pods at <code>/pods</code>. We can also get specs of the machine the <code>kubelet</code> is running on at <code>/spec</code>.</p><h3 id="kube-proxy"><a href="#kube-proxy" class="headerlink" title="kube-proxy"></a>kube-proxy</h3><p>The <code>kube-proxy</code> component runs on each node and proxies UDP, TCP, and SCTP packets (it doesn’t understand HTTP). It maintains the network rules on the host and handles transmission of packets between pods, the host, and the outside world. It acts like a network proxy and load balancer for pods running on the node by implementing east&#x2F;west load-balancing using NAT in <code>iptables</code>.</p><p>The <code>kube-proxy</code> process stands in between the network Kubernetes is attached to and the pods that are running on that particular node. It is essentially the core networking component of Kubernetes and is responsible for ensuring that communication is maintained efficiently across all elements of the cluster. When a user creates a Kubernetes service object, the <code>kube-proxy</code> instance is responsible to translate that object into meaningful rules in the local <code>iptables</code> rule set on the worker node. <code>iptables</code> is used to translate the virtual IP assigned to the service object to all of the pod IPs mapped by the service.</p><h3 id="Container-Runtime"><a href="#Container-Runtime" class="headerlink" title="Container Runtime"></a>Container Runtime</h3><p>The container runtime is responsible for pulling the images from public or private registries and running containers based on those images. The most popular engine is <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.docker.com/">Docker</a>, although Kubernetes supports container runtimes from <a target="_blank" rel="noopener external nofollow noreferrer" href="https://coreos.com/rkt/">rkt</a>, <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/opencontainers/runc">runc</a> and <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/opencontainers/runtime-spec">others</a>. As previously mentioned, <code>kubelet</code> interacts directly with container runtime to start, stop, or delete containers.</p><h3 id="cAdvisor"><a href="#cAdvisor" class="headerlink" title="cAdvisor"></a>cAdvisor</h3><p><code>cAdvisor</code> is an open-source agent that monitors resource usage and analyzes the performance of containers. Originally created by Google, cAdvisor is now integrated with <code>kubelet</code>.</p><p>The <code>cAdvisor</code> instance on each node collects, aggregates, processes, and exports metrics such as CPU, memory, file, and network usage for all running containers. All data is sent to the scheduler to ensure that it knows about the performance and resource usage inside of the node. This information is used to perform various orchestration tasks like scheduling, horizontal pod scaling, and managing container resource limits.</p><h2 id="Observing-Node-Component-Endpoints"><a href="#Observing-Node-Component-Endpoints" class="headerlink" title="Observing Node Component Endpoints"></a>Observing Node Component Endpoints</h2><p>Next, we will be installing a Kubernetes cluster (with the help of Rancher) so we can explore few of the APIs exposed by the node components. To perform this demo, we will need the following: - a Google Cloud Platform account, the free tier provided is more than enough (any other cloud should work the same) - a host where Rancher will be running (can be a personal PC&#x2F;Mac or a VM in a public cloud) - on same host <a target="_blank" rel="noopener external nofollow noreferrer" href="https://cloud.google.com/sdk/install">Google Cloud SDK</a> should be installed along <a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a>. Make sure that <code>gcloud</code> has access to your Google Cloud account by authenticating with your credentials (<code>gcloud init</code> and <code>gcloud auth login</code>). - Kubernetes cluster running on Google Kubernetes Engine (running EKS or AKS should be the same)</p><h3 id="Starting-a-Rancher-Instance"><a href="#Starting-a-Rancher-Instance" class="headerlink" title="Starting a Rancher Instance"></a>Starting a Rancher Instance</h3><p>To begin, start a Rancher instance. There is a very intuitive <a target="_blank" rel="noopener external nofollow noreferrer" href="https://rancher.com/quick-start/">getting started guide for Rancher</a> that you can follow for this purpose.</p><h3 id="Using-Rancher-to-deploy-a-GKE-cluster"><a href="#Using-Rancher-to-deploy-a-GKE-cluster" class="headerlink" title="Using Rancher to deploy a GKE cluster"></a>Using Rancher to deploy a GKE cluster</h3><p>Use Rancher to set up and configure your Kubernetes cluster, follow the how-to <a target="_blank" rel="noopener external nofollow noreferrer" href="https://rancher.com/docs/rancher/v2.x/en/cluster-provisioning/hosted-kubernetes-clusters/gke/">guide</a>.</p><p>As soon as cluster is deployed, we can make a quick Nginx deployment to use for testing:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cat</span> nginx_deployment.yaml</span><br><span class="line">---</span><br><span class="line"> apiVersion: extensions/v1beta1</span><br><span class="line"> kind: Deployment</span><br><span class="line"> metadata:</span><br><span class="line">   name: nginx-deployment</span><br><span class="line"> spec:</span><br><span class="line">   replicas: 3</span><br><span class="line">   template:</span><br><span class="line">     metadata:</span><br><span class="line">       labels:</span><br><span class="line">         app: nginx</span><br><span class="line">     spec:</span><br><span class="line">       containers:</span><br><span class="line">         - name: nginx</span><br><span class="line">           image: nginx</span><br><span class="line">           ports:</span><br><span class="line">             - containerPort: 80</span><br><span class="line">kubectl apply -f nginx_deployment.yaml</span><br><span class="line">deployment.extensions <span class="string">&quot;nginx-deployment&quot;</span> created</span><br></pre></td></tr></table></figure><p>In order to interact with Kubernetes API, we need to start a proxy server on your local machine:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl proxy &amp;</span><br><span class="line">[1] 3349</span><br><span class="line">$ Starting to serve on 127.0.0.1:8001</span><br></pre></td></tr></table></figure><p>Let’s check the progress to see it is running and listening to the default port:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">netstat -anp | grep 8001 | grep LISTEN</span><br><span class="line">tcp        0      0 127.0.0.1:8001          0.0.0.0:*               LISTEN      3349/kubectl</span><br></pre></td></tr></table></figure><p>Now, in your browser, check the various endpoints that <code>kubelet</code> exposes:</p><img src="/kubernetes/understanding-the-kubernetes-node/02-rancher-k8s-node-components-endpoints-all.png" title="Fig. 2: kubelet API endpoints"><p>Fig. 2: kubelet API endpoints</p><p>Next, display the list of your cluster’s available nodes:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl get nodes</span><br><span class="line">NAME                                     STATUS   ROLES    AGE     VERSION</span><br><span class="line">gke-c-cvknh-default-pool-fc8937e2-h2n9   Ready    &lt;none&gt;   3h13m   v1.12.5-gke.5</span><br><span class="line">gke-c-cvknh-default-pool-fc8937e2-hnfl   Ready    &lt;none&gt;   3h13m   v1.12.5-gke.5</span><br><span class="line">gke-c-cvknh-default-pool-fc8937e2-r4z1   Ready    &lt;none&gt;   3h13m   v1.12.5-gke.5</span><br></pre></td></tr></table></figure><p>We can check the <code>spec</code> for any of the listed nodes using the API. In this example, we created a 3 node cluster, using the <code>n1-standard-1</code> machine type (1 vCPU, 3.75GB RAM, root size disk of 10GB). We can confirm these specs by accessing the dedicated endpoint:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://localhost:8001/api/v1/nodes/gke-c-cvknh-default-pool-fc8937e2-h2n9/proxy/spec/</span><br><span class="line">curl http://localhost:8001/api/v1/nodes/gke-c-cvknh-default-pool-fc8937e2-hnfl/proxy/spec/</span><br><span class="line">curl http://localhost:8001/api/v1/nodes/gke-c-cvknh-default-pool-fc8937e2-r4z1/proxy/spec/</span><br></pre></td></tr></table></figure><img src="/kubernetes/understanding-the-kubernetes-node/04-rancher-k8s-node-components-endpoints-spec.png" title="Fig. 3: Kubernetes node spec listing"><p>Fig. 3: Kubernetes node spec listing</p><p>Using same <code>kubelet</code> API with a different endpoint, we can check the Nginx pods we created to see what nodes they are running on.</p><p>First, list the running pods:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">kubectl get pods</span><br><span class="line">NAME                               READY     STATUS    RESTARTS   AGE</span><br><span class="line">nginx-deployment-c5b5c6f7c-d429q   1/1       Running   0          1m</span><br><span class="line">nginx-deployment-c5b5c6f7c-w7qtc   1/1       Running   0          1m</span><br><span class="line">nginx-deployment-c5b5c6f7c-x9t8g   1/1       Running   0          1m</span><br></pre></td></tr></table></figure><p>Now, we can <code>curl</code> the <code>/proxy/pods</code> endpoint for each node to see the list of pods its running:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://localhost:8001/api/v1/nodes/gke-c-cvknh-default-pool-fc8937e2-h2n9/proxy/pods</span><br><span class="line">curl http://localhost:8001/api/v1/nodes/gke-c-cvknh-default-pool-fc8937e2-hnfl/proxy/pods</span><br><span class="line">curl http://localhost:8001/api/v1/nodes/gke-c-cvknh-default-pool-fc8937e2-r4z1/proxy/pods</span><br></pre></td></tr></table></figure><img src="/kubernetes/understanding-the-kubernetes-node/03-rancher-k8s-node-components-endpoint-pods.png" title="Fig. 4: Kubernetes node" alt="s list of pods"><p>Fig. 4: Kubernetes node’s list of pods</p><p>We can also check the cAdvisor endpoint, which outputs lots of data in Prometheus format. By default, this is available at the <code>/metrics</code> HTTP endpoint:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://localhost:8001/api/v1/nodes/gke-c-cvknh-default-pool-fc8937e2-h2n9/proxy/metrics/cadvisor</span><br></pre></td></tr></table></figure><img src="/kubernetes/understanding-the-kubernetes-node/05-rancher-k8s-node-components-endopoint-cAdvisor.png" title="Fig. 5: Kubernetes &#x2F;metrics endpoint"><p>Fig. 5: Kubernetes &#x2F;metrics endpoint</p><p>The same cAdvisor or pod information can also be obtained by SSHing into the node and making direct calls to the <code>kubelet</code> port:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcloud compute ssh admin@gke-c-cvknh-default-pool-fc8937e2-h2n9 --zone europe-west4-c</span><br><span class="line"></span><br><span class="line">admin@gke-c-cvknh-default-pool-fc8937e2-h2n9 ~ $ curl localhost:10255/metrics/cadvisor</span><br><span class="line">admin@gke-c-cvknh-default-pool-fc8937e2-h2n9 ~ $ curl localhost:10255/pods</span><br></pre></td></tr></table></figure><h3 id="Cleanup"><a href="#Cleanup" class="headerlink" title="Cleanup"></a>Cleanup</h3><p>To clean up the resources we used in this article, let’s delete the Kubernetes cluster from Rancher UI (simply select the cluster and hit the <code>Delete</code> button). This will remove all the nodes our cluster was using, along with the associated IP addresses. If you used a VM in a public cloud to run Rancher, you will need to take care of that too. Find out your instance name, then delete it:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ gcloud compute --project=&lt;&lt;<span class="string">YOUR_PROJECT_ID&gt;&gt; instances list</span></span><br><span class="line"><span class="string">$ gcloud compute --project=&lt;&lt;YOUR_PROJECT_ID</span>&gt;&gt; instances delete &lt;&lt;<span class="string">INSTANCE_NAME&gt;&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Conclusions"><a href="#Conclusions" class="headerlink" title="Conclusions"></a>Conclusions</h2><p>In this article, we’ve discussed the key components of Kubernetes node machines. Afterwards, we deployed a Kubernetes cluster using Rancher and made a small deployment to help us play with the <code>kubelet</code> API. To learn more about Kubernetes and its architecture, a great starting point is the official <a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/concepts/overview/components/">documentation</a>.</p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">IT老男孩</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span> <span class="post-copyright-info"><a href="https://www.xtplayer.cn/kubernetes/understanding-the-kubernetes-node/">https://www.xtplayer.cn/kubernetes/understanding-the-kubernetes-node/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a rel="noopener noreferrer" href="https://www.xtplayer.cn" target="_blank">IT老男孩</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/cicd/create-a-full-fledged-gitops-pipeline/"><img class="prev-cover" src="/img/gkihqEjXxJ5UZ1C.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">创建一个成熟的 GitOps 流水线需要做哪些决定？</div></div></a></div><div class="next-post pull-right"><a href="/kubernetes/kubernetes-tackling-resource-consumption/"><img class="next-cover" src="/img/gkihqEjXxJ5UZ1C.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Kubernetes: Tackling Resource Consumption</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i> <span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/kubernetes/about-kubernetes-1.20/" title="了解 Kubernetes 1.20"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-15</div><div class="title">了解 Kubernetes 1.20</div></div></a></div><div><a href="/kubernetes/api-server-and-etcd-health-state-check/" title="Api Server 和 ETCD 健康状态检查"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-22</div><div class="title">Api Server 和 ETCD 健康状态检查</div></div></a></div><div><a href="/kubernetes/automatic-k8s-deployment-tool/" title="K8S 自动部署工具"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-06</div><div class="title">K8S 自动部署工具</div></div></a></div><div><a href="/kubernetes/autoscaling/" title="Kubernetes 规范中标签的重要性"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-19</div><div class="title">Kubernetes 规范中标签的重要性</div></div></a></div><div><a href="/kubernetes/concepts-and-matters/" title="Kubernetes 概念及其重要性"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-15</div><div class="title">Kubernetes 概念及其重要性</div></div></a></div><div><a href="/kubernetes/controller-manager-and-scheduler-unavailable/" title="记一次 controller manager and scheduler unavailable 问题分析"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-24</div><div class="title">记一次 controller manager and scheduler unavailable 问题分析</div></div></a></div><div><a href="/kubernetes/custom-serviceaccount/" title="自定义服务账户（Service Account）"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-09</div><div class="title">自定义服务账户（Service Account）</div></div></a></div><div><a href="/kubernetes/docker-credentials-secret/" title="记一次镜像仓库凭证相关问题分析"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-23</div><div class="title">记一次镜像仓库凭证相关问题分析</div></div></a></div><div><a href="/kubernetes/fast-migration-pod-when-node-unavailable/" title="K8S 节点不可用时快速迁移 Pods"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-16</div><div class="title">K8S 节点不可用时快速迁移 Pods</div></div></a></div><div><a href="/kubernetes/forces-delete-terminated-namespace/" title="强制删除 Terminating 状态的 namespace"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-01</div><div class="title">强制删除 Terminating 状态的 namespace</div></div></a></div><div><a href="/kubernetes/ingress-configuration-demo/" title="Ingress 常用配置（持续更新）"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-11</div><div class="title">Ingress 常用配置（持续更新）</div></div></a></div><div><a href="/kubernetes/k8s-automatic-elastic-expansion/" title="Kubernetes 自动弹性伸缩"><img class="cover" src="/img/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-02</div><div class="title">Kubernetes 自动弹性伸缩</div></div></a></div></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4244806813321801" data-ad-slot="9845679202" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpeg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' width="110px" height="110px" alt="avatar"><div class="author-info__name">IT老男孩</div><div class="author-info__description">IT老男孩 - 原名系统玩家，分享 IT 相关技术文章，分享工作中的最佳实践。</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">132</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">96</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/rancher"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xiaoluhong" target="_blank" rel="external nofollow noreferrer noopener" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1044281310@qq.com" target="_blank" rel="external nofollow noreferrer noopener" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录导航</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Understanding-Kubernetes-and-Its-Abstractions"><span class="toc-number">2.</span> <span class="toc-text">Understanding Kubernetes and Its Abstractions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kubernetes-Node-Components-in-Detail"><span class="toc-number">3.</span> <span class="toc-text">Kubernetes Node Components in Detail</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#kubelet"><span class="toc-number">3.1.</span> <span class="toc-text">kubelet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kube-proxy"><span class="toc-number">3.2.</span> <span class="toc-text">kube-proxy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Container-Runtime"><span class="toc-number">3.3.</span> <span class="toc-text">Container Runtime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cAdvisor"><span class="toc-number">3.4.</span> <span class="toc-text">cAdvisor</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Observing-Node-Component-Endpoints"><span class="toc-number">4.</span> <span class="toc-text">Observing Node Component Endpoints</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Starting-a-Rancher-Instance"><span class="toc-number">4.1.</span> <span class="toc-text">Starting a Rancher Instance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Using-Rancher-to-deploy-a-GKE-cluster"><span class="toc-number">4.2.</span> <span class="toc-text">Using Rancher to deploy a GKE cluster</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cleanup"><span class="toc-number">4.3.</span> <span class="toc-text">Cleanup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusions"><span class="toc-number">5.</span> <span class="toc-text">Conclusions</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/rancher/waiting-for-node-to-register-either-cluster-is-not-ready-for-registering-or-etcd-and-controlplane-node-have-to-be-registered-first/" title="Waiting for node to register. Either cluster is not ready for registering or etcd and controlplane node have to be registered first">Waiting for node to register. Either cluster is not ready for registering or etcd and controlplane node have to be registered first</a><time datetime="2022-09-17T06:33:50.000Z" title="发表 2022-09-17 14:33:50">2022-09-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/mysql/how-to-get-the-sizes-of-the-tables-of-a-mysql-database/" title="如何查看 MySQL 数据库容量大小，表容量大小，索引容量大小？">如何查看 MySQL 数据库容量大小，表容量大小，索引容量大小？</a><time datetime="2022-05-17T08:48:50.000Z" title="发表 2022-05-17 16:48:50">2022-05-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/rancher/either-cluster-is-not-ready-for-registering/" title="node-agent 报错 Either cluster is not ready for registering, cluster is currently provisioning, or etcd, controlplane and worker node have to be registered">node-agent 报错 Either cluster is not ready for registering, cluster is currently provisioning, or etcd, controlplane and worker node have to be registered</a><time datetime="2022-05-14T05:13:09.000Z" title="发表 2022-05-14 13:13:09">2022-05-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/prometheus/prometheus-adapter/" title="Prometheus Adapter 安装">Prometheus Adapter 安装</a><time datetime="2022-04-04T08:26:12.000Z" title="发表 2022-04-04 16:26:12">2022-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/prometheus/custom-parameter/" title="自定义集群监控参数">自定义集群监控参数</a><time datetime="2022-03-28T11:10:20.000Z" title="发表 2022-03-28 19:10:20">2022-03-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/rancher/rancher-new-forums/" title="全新论坛启用，Rancher 中文社区迈入新阶段">全新论坛启用，Rancher 中文社区迈入新阶段</a><time datetime="2022-03-25T13:16:03.000Z" title="发表 2022-03-25 21:16:03">2022-03-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/coredns/accelerate-external-domain-resolution/" title="coreDNS 加速外部域名解析">coreDNS 加速外部域名解析</a><time datetime="2021-07-17T05:12:27.000Z" title="发表 2021-07-17 13:12:27">2021-07-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/longhorn/ai-at-the-edge-with-k3s-nvidia-jetson-nano-object-detection-real-time-video-analytics-src/" title="AI at the Edge with K3s and NVIDIA Jetson Nano: Object Detection and Real-Time Video Analytics">AI at the Edge with K3s and NVIDIA Jetson Nano: Object Detection and Real-Time Video Analytics</a><time datetime="2021-04-20T16:22:57.000Z" title="发表 2021-04-21 00:22:57">2021-04-21</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4244806813321801" data-ad-slot="5141213090" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By IT老男孩</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://beian.miit.gov.cn"><img class="icp-icon" width="25px" height="17px" src="/img/icp.png" alt="icp"><span>蜀ICP备20023095号-1</span></a> <a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=51010702002006"><span>川公网安备51010702002006号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text" aria-label="Search"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/instantpage.min.js" type="module"></script><script src="/js/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="5169987169" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="/css/APlayer.min.css" media="print" onload='this.media="all"'><script src="/js/APlayer.min.js"></script><script src="/js/Meting.min.js"></script><script src="/js/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!0,scrollRestoration:!1});document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","G-WDVQSZ43MX",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:send",(function(){if("object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="/js/busuanzi.pure.mini.js"></script><script>!function(){var e=document.createElement("script");e.src="https://sf1-scmcdn-tos.pstatp.com/goofy/ttzz/push.js?abca38a75f1ee646121b4cdefd4e13cef04782c449861f0dbdffcd879911999e0ea61db5c17bca91cb6b39891e5c5ae8de9c557b8186e0f895b49e96a4810ca7",e.id="ttzz";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(e,c)}(window)</script></div></body></html>